<body>
  <div class="container">
    <h1>
      <img alt=Maker src=https://makerdao.com/splash/images/logo.svg>
      <span>#otc</span>
    </h1>

    <p>
      This is a simple on-chain OTC market for {{baseCurrency}}. Either pick an order below (in which case delivery will happen instantly), or <a href="#neworder">submit a new order</a>.
    </p>

    <p class="text-danger">
      <strong>Warning!</strong> MakerOTC is undergoing alpha testing: Proceed at your own risk, and use only small amounts of ETH and MKR.
    </p>

    <p>
      Network: {{network}}
      {{#unless isConnected}}
        (not connected)
      {{else}}
        {{#if syncing}}
          (syncing {{syncingPercentage}}%)
        {{else}}
          {{#if outOfSync}}
            (out of sync, waiting for synchronization)
          {{else}}
            {{#if loading}}
              (loading offers {{loadingProgress}}%)
            {{else}}
              {{#if ready}}
                (ready)
              {{/if}}
            {{/if}}
          {{/if}}
        {{/if}}
      {{/unless}}
    </p>

    {{#if ready}}
      {{#unless equals network 'private'}}
        <p>Contract: <a href={{contractHref}}>Etherscan.io</a></p>
      {{/unless}}
      {{> accountSelector }}
      <p>Balance: {{formatBalance ETHBalance}} ETH</p>
      <p>Tokens: {{#each token in allTokens}}{{formatBalance token.balance}} {{#if equals token._id 'ETH'}}<a href="#makereth">{{token._id}}</a>{{else}}{{token._id}}{{/if}} | {{/each}}</p>
      <p><a href="#allowance">Allowance</a>: {{#each token in allTokens}}{{formatBalance token.allowance}} {{token._id}} | {{/each}}</p>

      {{#if contractExists}}
        <div class=row>
          <section>
            {{> orderbook title='Buy orders' subtitle=(concat '(pick on to sell ' baseCurrency ')') priceLabel='Bid' orders=(findOffers 'type' 'bid')}}
          </section>
          <section>
            {{> orderbook title='Sell orders' subtitle=(concat '(pick on to buy ' baseCurrency ')') priceLabel='Ask' orders=(findOffers 'type' 'ask')}}
          </section>
        </div>
        <div class=row>
          <section>
            {{> neworder}}
          </section>
          <section>
            {{> orderbook title='My orders' subtitle='' priceLabel='Price' orders=(findOffers 'owner' address)}}
          </section>
        </div>
        <div class=row>
          <section>
            <h2 id="allowance">Allowance</h2>
            {{#each token in allTokens}}
              {{> newallowance token=token}}
            {{/each}}
          </section>
          <section>
            {{> makereth}}
          </section>
        </div>

        {{> offermodal offer=(findOffer selectedOffer)}}
      {{else}}
        <p>
          Could not find the contract on your current blockchain environment.
        </p>
      {{/if}}
    {{/if}}
    {{#unless isConnected}}
      {{> noEthereum}}
    {{/unless}}
  </div>
</body>
